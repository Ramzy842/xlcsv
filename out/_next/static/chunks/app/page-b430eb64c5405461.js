(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{67:function(){},2061:function(){},6858:function(e,t,s){Promise.resolve().then(s.bind(s,680))},680:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var a=s(7437),n=s(2265),l=s(7800),r=s(6648),o=e=>{let{file:t}=e,{name:s,downloadReqs:n}=t;return(0,a.jsxs)("div",{className:"w-full bg-black/40 backdrop-blur-md rounded-sm flex justify-between items-center px-2 mb-2 py-1 drop-shadow-lg z-40",children:[(0,a.jsx)("p",{className:"text-white z-40 text-sm",children:s}),(0,a.jsx)("button",{onClick:()=>{l.NC(n.new_wb,n.fileNameWithoutExt+".csv")},children:(0,a.jsx)(r.default,{priority:!0,src:"./assets/upload.svg",className:"select-none ",width:18,height:18,alt:"download file"})})]})},i=s(9315),c=s.n(i),d=s(7170),h=s(7037);let u=["iron-man","captain-america","thor","black-widow","spider-man","hulk","wolverine","black-panther","doctor-strange","scarlet-witch","falcon","winter-soldier","vision","ant-man","wasp","captain-marvel","deadpool","venom","daredevil","elektra","punisher","blade","ghost-rider","loki","thanos","magneto","professor-x","cyclops","jean-grey","storm","beast","ice-man","angel","colossus","rogue","gambit","mystique","superman","batman","wonder-woman","aquaman","flash","green-lantern","cyborg","shazam","harley-quinn","joker","poison-ivy","two-face","riddler","penguin","scarecrow","bane","darkseid","lex-luthor","catwoman","martian-manhunter"];var m=e=>{let{files:t,folderName:s}=e,n=async e=>{let a={};for(let s=0;s<t.length;s++)a[t[s].name]=e[s];if(a){let e=new(c());for(let t in a)e.file(t,a[t],{binary:!0});let t=await e.generateAsync({type:"blob"}),n=(0,h._8)({dictionaries:[h.Dv,h.O9,u]});(0,d.saveAs)(t,s||n)}};return(0,a.jsxs)("div",{className:"max-w-6xl bg-files bg-cover bg-no-repeat mx-auto absolute h-1/2 bottom-0 right-0 left-0 rounded-t-xl p-6 drop-shadow-2xl opacity-0 transition-all ".concat(t&&t.length&&"opacity-100"," "),children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h1",{className:"font-extrabold text-xl tracking-wide white mr-2 z-40",children:"Files"}),(0,a.jsx)(r.default,{src:"./assets/file.svg",className:"z-40",height:20,width:20,alt:"files icon"})]}),(0,a.jsxs)("button",{onClick:()=>{let e=[];for(let s=0;s<t.length;s++)e.push(l.cW(t[s].downloadReqs.new_wb,{bookType:"csv",type:"binary"}));n(e)},className:"".concat(t.length?"flex":"hidden"," items-center bg-green-600 py-2 px-3 text-sm text-white z-40 rounded-sm hover:bg-green-800 group transition-all outline-none"),children:["Download All",(0,a.jsx)(r.default,{className:"ml-3",src:"./assets/downloadAll.svg",height:18,width:18,alt:"download all files"})]})]}),t.length?(0,a.jsx)("div",{className:"overflow-y-scroll h-[95%] pr-2",children:t.map((e,t)=>(0,a.jsx)(o,{id:t+1,file:e},t))}):(0,a.jsx)("div",{className:"h-full text-center flex justify-center items-center",children:(0,a.jsx)("h1",{className:"text-7xl font-bold text-white  z-40",children:"No files yet"})})]})};let f=(0,n.createContext)(),x=e=>{let{children:t}=e,[s,l]=(0,n.useState)(!1),[r,o]=(0,n.useState)(0);return(0,a.jsx)(f.Provider,{value:{isActive:s,setIsActive:l,elapsedTime:r,setElapsedTime:o},children:t})};var g=e=>{let{err:t}=e,{isActive:s}=(0,n.useContext)(f),[l,r]=(0,n.useState)(0),[o,i]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=null;return e=setInterval(()=>{t||100===l||l<0||l>100||!s||r(e=>e+1)},1),()=>clearTimeout(e)},[s]),(0,n.useEffect)(()=>{t?r(0):s||!(l>0)||t||o||(r(100),i(!0))},[l]),(0,n.useEffect)(()=>{o&&(setTimeout(()=>{r(0)},2e3),i(!1))},[o]),(0,a.jsx)("div",{className:"bg-gradient-to-r from-yellow-500 to-green-500 text-center pb-0.5 text-white drop-shadow-lg",style:{transition:"width 0.3s ease-in-out",width:"".concat(l,"%")},children:(0,a.jsx)("a",{className:"bg-black font-orbitron text-2xl py-1 tracking-[.5em] w-screen block",href:"/",children:"XLCSV"})},l)},p=e=>{let{files:t,setFiles:s,setErr:o,err:i,folderName:c,setFolderName:d,uploadedFiles:h,setUploadedFiles:u}=e,[m,x]=(0,n.useState)(""),[g,p]=(0,n.useState)([]),[w,b]=(0,n.useState)(""),[j,v]=(0,n.useState)(""),{setElapsedTime:N,setIsActive:y,isActive:k}=(0,n.useContext)(f);function S(e){e.stopPropagation(),e.preventDefault(),"dragenter"===e.type||"dragover"===e.type?v("border-4 border-green-400"):v("");let t=e.dataTransfer.items;for(let e=0;e<t.length;e++){let s=t[e].webkitGetAsEntry();s&&function e(t,s){s=s||"",t.isFile?t.file(function(e){u(t=>[...t,e])}):t.isDirectory&&(d(t.name),t.createReader().readEntries(function(a){for(let n=0;n<a.length;n++)e(a[n],s+t.name+"/")}))}(s)}}function _(e){y(!1),"Sheet name cannot exceed 31 chars"===e.message?o("File name should not exceed 31 letters"):o(e.message),s([])}return(0,n.useEffect)(()=>{h.length&&h[0]&&(v(""),x(h[h.length-1].name),b(function(e){let t={KB:1024,GB:1073741824};if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(t.KB));return(e/Math.pow(t.KB,s)).toFixed(1)+" "+(s>=t.GB/t.KB?"GB":["Bytes","KB","MB","GB"][s])}(h.map(e=>Number(e.size)).reduce((e,t)=>e+t)))),v("")},[h]),(0,n.useEffect)(()=>{g.length&&g.length===h.length&&!i&&(s(g),y(!1))},[g]),(0,a.jsxs)("div",{id:"upload-zone",className:"".concat(!m&&"w-120 h-40 p-0"," flex flex-col items-center justify-center mx-auto mt-16 bg-black/70 backdrop-blur-xl rounded-md p-4 drop-shadow-2xl max-w-lg ").concat(m&&!t.length&&!i&&"w-auto h-auto border-b-4 border-yellow-500 "," ").concat(t.length&&t.length===h.length&&!i&&"border-b-4 w-auto border-green-500"," ").concat(j," ").concat(i&&"border-b-4 w-auto border-red-500"," "),children:[!h.length&&(0,a.jsxs)("div",{className:"flex flex-col items-center w-full h-full justify-center",onDragEnter:S,onDragOver:S,onDrop:S,onDragLeave:S,children:[(0,a.jsx)("p",{className:"font-semibold mb-4 text-white ",children:"Drop Your Files Here"}),(0,a.jsx)(r.default,{src:"./assets/upload.svg",width:24,height:24,className:"select-none",alt:"upload"})]}),m&&(0,a.jsxs)("div",{className:"flex text-white justify-between w-full  ",children:[(0,a.jsxs)("div",{className:"w-3/5 max-w-md",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(r.default,{className:"mr-2 select-none",src:"./assets/folder.svg",height:18,width:18,alt:"folder"}),(0,a.jsxs)("p",{className:"font-bold truncate",children:["Name:"," ",(0,a.jsx)("span",{className:"font-normal ml-1",children:c||m})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(r.default,{className:"mr-2 select-none",src:"./assets/database.svg",height:18,width:18,alt:"size"}),(0,a.jsxs)("p",{className:"font-bold truncate",children:["Size:"," ",(0,a.jsx)("span",{className:"font-normal ml-1",children:w})]})]})]}),m&&!t.length&&!i&&(0,a.jsxs)("div",{className:"flex items-center justify-center cursor-pointer",onClick:function(e){e.stopPropagation(),e.preventDefault(),y(!0);for(let e=0;e<h.length;e++){let t="application/vnd.ms-excel"===h[e].type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===h[e].type;h[e].type&&t&&h[e].arrayBuffer().then(t=>(function(e,t){let s=new Uint8Array(e),a=l.ij(s,{type:"array"}),n=a.SheetNames[0],r=a.Sheets[n],o=l.P6.sheet_to_json(r,{raw:!0}),i=l.P6.json_to_sheet(o),c=l.P6.book_new(),d=null;t&&(d=t.name);let h=d.substring(0,d.lastIndexOf("."));l.P6.book_append_sheet(c,i,h),p(e=>[...e,{name:"".concat(h,".csv"),downloadReqs:{new_wb:c,fileNameWithoutExt:h}}])})(t,h[e])).catch(_)}},children:[(0,a.jsx)("p",{className:"mr-2",children:"Start conversion"}),(0,a.jsx)(r.default,{src:"./assets/arrow-r.svg",width:20,height:20,className:"cursor-pointer",alt:"start conversion"})]}),t.length>0&&t.length===h.length&&!i&&(0,a.jsx)("div",{className:"flex items-center justify-center select-none",children:(0,a.jsx)(r.default,{src:"./assets/check.svg",width:20,height:20,alt:"Conversion done"})}),i&&(0,a.jsx)("div",{className:"flex items-center justify-center select-none",children:(0,a.jsx)(r.default,{src:"./assets/x.svg",width:24,height:24,alt:"Conversion Failed"})})]}),h.length>0&&(0,a.jsx)(r.default,{src:"./assets/loader.svg",className:"opacity-0 ".concat(k&&!i&&"opacity-100"," animate-spin select-none"),width:20,height:20,alt:"loading"}),(t.length>0&&t.length===h.length||i)&&(0,a.jsx)(r.default,{src:"./assets/refresh.svg",className:"cursor-pointer",width:20,height:20,alt:"refresh",onClick:function(){x(""),b(""),u([]),s([]),p([]),N(0),y(!1),o(""),d("")}})]})},w=e=>{let{err:t}=e;return(0,a.jsxs)("div",{className:"flex items-center absolute right-4 top-20 bg-red-200 text-red-600 font-semibold px-4 py-2 border-b-2 border-red-500 drop-shadow-3xl text-sm",children:[(0,a.jsx)(r.default,{src:"./assets/warning.svg",width:24,height:24,className:"select-none mr-2",alt:"warning"}),t]})},b=e=>{let{files:t,uploadedFiles:s}=e,{elapsedTime:l,setElapsedTime:o,isActive:i}=(0,n.useContext)(f),c=(0,n.useRef)(0);return(0,n.useEffect)(()=>{if(i){c.current=performance.now();let e=setInterval(()=>{o((performance.now()-c.current)/1e3)},1);return()=>clearInterval(e)}},[i]),(0,a.jsxs)("div",{className:"absolute top-12 right-8 flex justify-center  py-2 px-4 rounded-sm items-center  mx-auto mt-4 drop-shadow-md opacity-0 ".concat(t.length&&t.length===s.length&&"transition-opacity opacity-100"),children:[(0,a.jsx)(r.default,{src:"./assets/clock.svg",width:24,height:24,className:"select-none mr-2",alt:"clock"}),(0,a.jsxs)("p",{className:"text-white font-semibold",children:["Converted in"," ",(0,a.jsxs)("span",{className:"text-green-800 bg-green-300 px-2 font-bold",children:[l.toFixed(1)," sec"]})]})]})};function j(){let[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)(""),[r,o]=(0,n.useState)(""),[i,c]=(0,n.useState)([]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x,{children:[(0,a.jsx)(g,{files:e,err:s}),s&&(0,a.jsx)(w,{err:s}),(0,a.jsx)(p,{files:e,setFiles:t,setErr:l,err:s,folderName:r,setFolderName:o,uploadedFiles:i,setUploadedFiles:c}),(0,a.jsx)(b,{files:e,uploadedFiles:i,setUploadedFiles:c})]}),(0,a.jsx)(m,{files:e,folderName:r,uploadedFiles:i})]})}}},function(e){e.O(0,[425,356,971,23,744],function(){return e(e.s=6858)}),_N_E=e.O()}]);